doctype html
html(lang="en")
  head
    meta(charset="UTF-8")
    meta(name="viewport", content="width=device-width, initial-scale=1.0")
    title Workforce Admin

    link(rel="stylesheet", href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css")
    link(rel="stylesheet", href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css")
    script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js")
    
    //- Include Icons (Path relative to this layout file)
    include ../../utils/icons.pug

    style.
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300..900&display=swap');
      :root {
        --app-bg: #0a0f18;
        --sidebar-bg: #0f141e; 
        --card-bg: #131b26;
        --text-light: #e5e7eb;
        --text-muted: #9ca3af;
        --admin-color: #3b82f6;
        --border-color: rgba(255, 255, 255, 0.08);
      }
      body { font-family: 'Inter', sans-serif; background-color: var(--app-bg); color: var(--text-light); height: 100vh; overflow: hidden; }
      
      /* --- TEXT VISIBILITY FIX --- */
      h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 { color: var(--text-light); }
      .text-muted { color: var(--text-muted) !important; }

      /* --- GLOBAL TABLE FIXES --- */
      .table {
        --bs-table-color: var(--text-light);
        --bs-table-bg: transparent;
        --bs-table-hover-color: var(--text-light);
        --bs-table-hover-bg: rgba(255, 255, 255, 0.03);
        color: var(--text-light);
      }
      .table thead th {
        border-bottom: 1px solid var(--border-color);
        color: var(--text-muted);
      }
      .table tbody td {
        border-bottom: 1px solid var(--border-color);
      }

      /* --- GLOBAL FORM FIXES --- */
      .form-control {
        background-color: rgba(255, 255, 255, 0.05);
        border: 1px solid var(--border-color);
        color: var(--text-light);
      }
      .form-control:focus {
        background-color: rgba(255, 255, 255, 0.1);
        color: white;
        border-color: var(--admin-color);
        box-shadow: none;
      }
      .form-control::placeholder {
        color: rgba(255, 255, 255, 0.4);
      }
      .input-group-text {
        background-color: rgba(255, 255, 255, 0.05);
        border: 1px solid var(--border-color);
        color: var(--text-muted);
      }

      /* --- Sidebar Styles --- */
      .dashboard-container { display: flex; height: 100%; flex-direction: column; }
      @media (min-width: 992px) { .dashboard-container { flex-direction: row; } }

      .sidebar { width: 280px; background-color: var(--sidebar-bg); border-right: 1px solid var(--border-color); display: flex; flex-direction: column; padding: 1.5rem; flex-shrink: 0; transition: transform 0.3s ease; }
      
      .nav-link { color: var(--text-muted); padding: 0.8rem 1rem; border-radius: 0.5rem; display: flex; align-items: center; margin-bottom: 0.5rem; font-weight: 500; text-decoration: none; }
      .nav-link:hover { color: var(--text-light); background-color: rgba(255, 255, 255, 0.05); }
      .nav-link.active { background-color: rgba(59, 130, 246, 0.15); color: var(--admin-color); font-weight: 600; }
      .nav-link i { margin-right: 0.75rem; font-size: 1.2rem; line-height: 1; }
      
      /* Mobile Header */
      .mobile-header { background-color: var(--sidebar-bg); border-bottom: 1px solid var(--border-color); padding: 1rem; display: flex; align-items: center; justify-content: space-between; }
      .offcanvas-dark { background-color: var(--sidebar-bg); color: var(--text-light); }
      .offcanvas-dark .btn-close { filter: invert(1); }

      .main-content { flex-grow: 1; overflow-y: auto; padding: 2rem; }
      
      /* Helper for Active Link Logic */
      - var activePage = activePage || 'dashboard'; 

      /* Hide/Show logic for responsiveness */
      @media (max-width: 991.98px) {
        .sidebar { display: none; }
        .mobile-header { display: flex !important; }
      }
      @media (min-width: 992px) {
        .mobile-header { display: none !important; }
      }

    //- THIS LINE FIXES THE ERROR: It allows child pages to append styles/variables
    block head

  body
    //- Navigation Mixin (Reusable for Desktop Sidebar & Mobile Offcanvas)
    mixin navContent()
      //- Navigation Main Menu
      h6.text-uppercase.text-muted.small.fw-bold.mb-3.mt-2 Main Menu
      nav.nav.flex-column.mb-4
        a.nav-link(href="dashboard", class=(activePage === 'dashboard' ? 'active' : ''))
          +icon('dashboard')
          | Dashboard
        a.nav-link(href="employees", class=(activePage === 'employees' ? 'active' : ''))
          +icon('user')
          | Employees
        a.nav-link(href="timesheets", class=(activePage === 'timesheets' ? 'active' : ''))
          +icon('clock')
          | Timesheets
        a.nav-link(href="holiday-requests", class=(activePage === 'calendar' ? 'active' : ''))
          +icon('calendar')
          | Holiday Requests
        a.nav-link(href="advance-requests", class=(activePage === 'money' ? 'active' : ''))
          +icon('money')
          | Advance Payment

    .dashboard-container
      
      //- --- MOBILE HEADER (Visible < 992px) ---
      .mobile-header.sticky-top
         .d-flex.align-items-center
           button.btn.btn-outline-secondary.border-0.me-2(type="button", data-bs-toggle="offcanvas", data-bs-target="#mobileSidebar")
             +icon('menu', 'fs-4')
           h5.mb-0.fw-bold.text-white Admin Portal

      //- --- DESKTOP SIDEBAR (Visible >= 992px) ---
      aside.sidebar
        .d-flex.align-items-center.mb-5.px-2
          .me-3.text-white.d-flex.align-items-center.justify-content-center(style="background: var(--admin-color); width: 32px; height: 32px; border-radius: 6px;")
             +icon('shield')
          h5.mb-0.fw-bold Workforce Admin
        
        +navContent()

        .mt-auto
          a.nav-link.text-danger(href="/admin-logout")
             +icon('logout')
             | Logout

      //- --- MOBILE OFFCANVAS SIDEBAR ---
      .offcanvas.offcanvas-start.offcanvas-dark(tabindex="-1", id="mobileSidebar")
        .offcanvas-header
          h5.offcanvas-title Admin Portal
          button.btn-close.btn-close-white(type="button", data-bs-dismiss="offcanvas")
        .offcanvas-body
          +navContent()
          .mt-auto
            a.nav-link.text-danger(href="/admin-logout")
               +icon('logout')
               | Logout

      //- --- MAIN CONTENT BLOCK (Pages fill this in) ---
      main.main-content
        block content