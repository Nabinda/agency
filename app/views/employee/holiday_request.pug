extends employee_layout.pug

block title
  title Holiday Request â€¢ Employee Portal

//- Define the main content block
block content

  h1.fw-bold.mb-4 Holiday Requests
  
  .row.g-4
    .col-lg-5
      //- --- NEW REQUEST FORM ---
      .card
        .card-header.border-bottom.border-light.border-opacity-10.p-4
          h5.fw-bold.mb-0 Submit New Request
        .card-body.p-4
          form
            //- Type Selection (Single Day / Date Range)
            .mb-4
              label.form-label.fw-bold(for="requestType") Type of Request
              // Note: We need to include form control styles in the layout's <style> block for consistency
              select.form-select#requestType(onchange="toggleDateInputs(this.value)")
                option(value="single") Single Day
                option(value="range") Date Range
                
            //- Date Inputs
            #singleDayFields.mb-4
              label.form-label.fw-bold(for="singleDate") Date of Holiday
              input.form-control#singleDate(type="date", required)
              
            #rangeDayFields.mb-4.d-none
              .row.g-3
                .col-md-6
                  label.form-label.fw-bold(for="startDate") Start Date
                  input.form-control#startDate(type="date")
                .col-md-6
                  label.form-label.fw-bold(for="endDate") End Date
                  input.form-control#endDate(type="date")

            //- Reason Textarea
            .mb-4
              label.form-label.fw-bold(for="holidayReason") Reason / Notes
              textarea.form-control#holidayReason(rows="3", placeholder="e.g., Family trip, personal time, etc.", required)

            //- Submit Button
            button.btn.btn-teal.w-100(type="submit")
              +icon('send', 'me-2')
              | Submit Request

    .col-lg-7
      //- --- REQUEST HISTORY TABLE ---
      .card
        .card-header.border-bottom.border-light.border-opacity-10.p-4
          h5.fw-bold.mb-0 Your Request History
        .card-body.p-0
          .list-group.list-group-flush
            +holidayRequestRow('Jan 1 - Jan 5', '5 Days', 'Family trip to Italy', 'Approved', 'var(--accent-green)')
            +holidayRequestRow('Dec 24', '1 Day', 'Christmas Eve', 'Rejected', 'var(--accent-red)')
            +holidayRequestRow('Mar 10 - Mar 12', '3 Days', 'House move', 'Pending', 'var(--accent-yellow)')
            +holidayRequestRow('Oct 31', '1 Day', 'Personal day', 'Approved', 'var(--accent-green)')

//- Script to handle Single Day vs. Date Range visibility
block append content
  script.
    function toggleDateInputs(type) {
      const single = document.getElementById('singleDayFields');
      const range = document.getElementById('rangeDayFields');
      const singleInput = document.getElementById('singleDate');
      const startInput = document.getElementById('startDate');
      const endInput = document.getElementById('endDate');

      if (type === 'range') {
        single.classList.add('d-none');
        range.classList.remove('d-none');
        singleInput.removeAttribute('required');
        startInput.setAttribute('required', 'required');
        endInput.setAttribute('required', 'required');
      } else {
        single.classList.remove('d-none');
        range.classList.add('d-none');
        singleInput.setAttribute('required', 'required');
        startInput.removeAttribute('required');
        endInput.removeAttribute('required');
      }
    }
    
    // Call once on load to ensure initial state is correct
    document.addEventListener('DOMContentLoaded', () => {
        const requestTypeElement = document.getElementById('requestType');
        if (requestTypeElement) {
            toggleDateInputs(requestTypeElement.value);
        }
    });

